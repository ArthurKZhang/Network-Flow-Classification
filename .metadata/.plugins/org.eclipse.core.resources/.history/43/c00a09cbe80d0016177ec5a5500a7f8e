package test;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

import pcap.databean.arthur.Pcap;
import pcap.util.arthur.ByteArrayUtil;
import pcap.util.arthur.ContentParser;
import pcap.util.arthur.PcapParser;

/**
 * for don't know certain content of .pcap file, we can't use JUnit test
 * framework. printing out contents is the only choice we can make.
 * 
 * @author Arthur
 */
public class PcapFileDecodeTest {
	public static void main(String[] args) {
		try {
			InputStream is = new FileInputStream("D:\\00DATA\\BS\\267num.pcap");
			Pcap pcap;
			pcap = PcapParser.unpack(is);
			is.close();
			// the number of packets caught in file.
			int contentSize = pcap.getData().size();
			System.out.println("file contains " + contentSize + "packages");
			byte[] content = pcap.getData().get(0).getContent();
			//data stores IP package
			byte[] ipPacket = ContentParser.getIpPackage(content);
			char[] chars = ByteArrayUtil.byteArrayTochar(ipPacket);
			for (int i = 0; i < chars.length; i++)
				System.out.println(chars[i]);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
