package pcap.util;

import java.util.Arrays;

public class ContentParser {
//	private byte[] frameHead = new byte[14];
//	public ContentParser
	public static byte[] getIpPackage(byte[] content){
		byte[] ipPackage = Arrays.copyOfRange(content, 14, content.length);
		return ipPackage;
	}
	
	public static String[] getSouAddrAndDesAddr(byte[] ipPackage){
		if(isIpv4(ipPackage)){
			byte[] sourAddrZone = Arrays.copyOfRange(ipPackage, 48, 63);
			byte[] desAddrZone = Arrays.copyOfRange(ipPackage, 64, 79);
			String sourAddr;
			String desAddr;
		}else{
			
		}
		return null;
	}
	private static boolean isIpv4(byte[] ipPackage){
		
		byte[] versionZone = Arrays.copyOfRange(ipPackage, 0, 4);
		ByteArrayUtil.reverseByteArray(versionZone);
		int version = (ByteArrayUtil.byteArrayToInt(versionZone) >> 4) & 0xf;
		
		return 4==ByteArrayUtil.byteArrayToInt(versionZone);
	}
	/*
	 * for(int i=0;i<4;i++){
				sbr.append((int)(content[b]&0xff));
                sbr.append(".");
			}
	 */
}
